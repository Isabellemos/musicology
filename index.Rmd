---
title: "Isabelle Mos"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: 
      version: 4
      bootswatch: minty
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(spotifyr)
library(compmus)

bicep <- get_playlist_audio_features("", "45igKB0TM7fCIDJVo8dWpZ")
bodzin <- get_playlist_audio_features("", "4DgGHEYzIbiKwBZaXdkVvF")

bicep_2 <- get_artist_audio_features('Bicep')
bodzin_2 <- get_artist_audio_features('Stephan Bodzin')

st_artists <- rbind(bicep_2, bodzin_2)

apricots_bicep <-
  get_tidy_audio_analysis("0WfOuXw05LJq4ik1lVvTzi") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)


river_bodzin <-
  get_tidy_audio_analysis("215z00CrTsmjBop1O4kbWz") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)


```

### Introduction

```{.tabset} 

I will be investigating the songs of the duo Bicep and compare this to the songs of Stephan Bodzin. Both Bicep and Bodzin are an electronic artists and have a very different and characteristic style. One can immediately recognize a song from Bicep or a song from Stephan Bodzin.

Bodzins songs typically have a baseline driven, emotive and hypnotic synth.

Biceps songs have an immediately recognisable shuffling beat, subtle bass and soaring vocals, a surefire way to get any rave absolutely heaving.

However these artists have a very different style, I think these artists are one of my all time favourites and I will never bore me. Therefore I am wondering if there are any simmilarities in the work of these artists, so I can find out if these artists have any commonalities which makes me love them, or if other aspects of their work makes me love their music. 

My corpus consists of the two playlists I made, one with most of the music of Bicep and one with most of the music from Stephan Bodzin. 

```



### Global orientation on Bicep and Bodzin
```{r}

st_artists %>% 
ggplot(aes(x = valence, y = energy, color = artist_name)) +
  geom_jitter() +
  geom_vline(xintercept = 0.5) +
  geom_hline(yintercept = 0.5) +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 1)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) +
  annotate('text', 0.25 / 2, 0.95, label = "Turbulent/Angry", fontface = "bold") +
  annotate('text', 1.75 / 2, 0.95, label = "Happy/Joyful", fontface = "bold") +
  annotate('text', 1.75 / 2, 0.05, label = "Chill/Peaceful", fontface = "bold") +
  annotate('text', 0.25 / 2, 0.05, label = "Sad/Depressing", fontface = "bold")

```
***
This graph gives a global analysis of the overall atmoshphere / vibe of the music of both artists. Both Bicep's and Bodzin's songs are mostly in the Turbulent / Angry section. Bodzins' songs also often lay in the sad/depressing segment. This is interesting since they both play at big festivals where the vibe is definitely not depressing. A small segment of their songs is in the happy/joyful segment though. However from this graph I can conclude that the artists have their 'Turbulent' and 'Angry' atmosphere in common. 



### The energy of Bicep and Bodzin
```{r}


```







### Chromograms

```{r}
apricots_bicep %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() + ggtitle('Apricots from Bicep')

river_bodzin %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() + ggtitle("River from Bodzin")
```

***


here is some textttt


### Cepstrograms 
```{r}

ataraxia <-
  get_tidy_audio_analysis("6wIlFCtQHeC8UyljWYnMoI") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

ataraxia %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() + ggtitle("Ataraxia - Stephan Bodzin")


singularity <-
  get_tidy_audio_analysis("0yuJtvXsapVOQfNDYxQ5mw") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

singularity %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() + ggtitle("Singularity - Stephan Bodzin")



boavista <-
  get_tidy_audio_analysis("3hw5kx3JoJ5k5SUAJRlmFq") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

boavista %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() + ggtitle("Boavista - Stephan Bodzin")



glue <-
  get_tidy_audio_analysis("2aJDlirz6v2a4HREki98cP") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

glue %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() + ggtitle("Glue - Bicep")



atlas <-
  get_tidy_audio_analysis("54TgI46OnNqcf0SyzQyCL6") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

atlas %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() + ggtitle("Atlas - Bicep")



apricots <-
  get_tidy_audio_analysis("0WfOuXw05LJq4ik1lVvTzi") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )

apricots %>%
  compmus_gather_timbre() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = basis,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  scale_fill_viridis_c() +                              
  theme_classic() + ggtitle("Apricots - Bicep")

```

***


Some ceptrograms of both artists. 


### Outliers of both artists. 

```{r}

glue <-
  get_tidy_audio_analysis("2aJDlirz6v2a4HREki98cP") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

glue %>%
  mutate(pitches = map(pitches, compmus_normalise, "chebyshev")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() + ggtitle('Glue - Bicep')



singularity <-
  get_tidy_audio_analysis("0yuJtvXsapVOQfNDYxQ5mw") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

singularity %>%
  mutate(pitches = map(pitches, compmus_normalise, "chebyshev")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() + ggtitle("Singularity - Bodzin")


```

***

This is a visualisation of two outliers, one of both artists. I think of these songs as ‘outliers’ because they are by far the most popular songs of both artists so I thought it would be interesting to look if there are certain extraordinary properties or similarities within their chromagrams. 

First chromogram is from the song Glue by Bicep. The first part of the song is a repetition of the same rhythm, which is visible in the chromagram. The highest magnitude is around D and G#|Ab / G. After this it is visible that this same rhythm keeps repeating throughout the song, but as the song is building up more elements are added (a voice and other electronic sounds). This makes the chromagram very mixed and a bit messy. Even though it is still possible to see the repeating rhythm, which you will notice if you listen to Glue. 
An extraordinary part in the chromagram is the yellow (high magnitude) stripe in the middle of the chromagram. This represents the high-pitched vocals, which is characteristic of the song Glue. 

The second chromagram is of the most popular Stephan Bodzin song, namely ’Singularity’. It is clear from the chromagram that the throughout the whole song there is a high magnitude on the G#|Ab, A and B notes. This forms a yellow ‘band’ on the top of the chromagram, so this represents the repeating bass-synth rhythm which is only composed of two chords plus the typical Bodzin-style synthesizers (this will be very clear when you listen to the song). 
What makes this song so specials is that the built-up is actually very simple and keeps repeating; there are some high pitches throughout the songs but the basis is really these two chords.  



### week 10 

```{r}

circshift <- function(v, n) {
  if (n == 0) v else c(tail(v, n), head(v, -n))
}

#      C     C#    D     Eb    E     F     F#    G     Ab    A     Bb    B
major_chord <-
  c(   1,    0,    0,    0,    1,    0,    0,    1,    0,    0,    0,    0)
minor_chord <-
  c(   1,    0,    0,    1,    0,    0,    0,    1,    0,    0,    0,    0)
seventh_chord <-
  c(   1,    0,    0,    0,    1,    0,    0,    1,    0,    0,    1,    0)

major_key <-
  c(6.35, 2.23, 3.48, 2.33, 4.38, 4.09, 2.52, 5.19, 2.39, 3.66, 2.29, 2.88)
minor_key <-
  c(6.33, 2.68, 3.52, 5.38, 2.60, 3.53, 2.54, 4.75, 3.98, 2.69, 3.34, 3.17)


key_templates <-
  tribble(
    ~name, ~template,
    "Gb:maj", circshift(major_key, 6),
    "Bb:min", circshift(minor_key, 10),
    "Db:maj", circshift(major_key, 1),
    "F:min", circshift(minor_key, 5),
    "Ab:maj", circshift(major_key, 8),
    "C:min", circshift(minor_key, 0),
    "Eb:maj", circshift(major_key, 3),
    "G:min", circshift(minor_key, 7),
    "Bb:maj", circshift(major_key, 10),
    "D:min", circshift(minor_key, 2),
    "F:maj", circshift(major_key, 5),
    "A:min", circshift(minor_key, 9),
    "C:maj", circshift(major_key, 0),
    "E:min", circshift(minor_key, 4),
    "G:maj", circshift(major_key, 7),
    "B:min", circshift(minor_key, 11),
    "D:maj", circshift(major_key, 2),
    "F#:min", circshift(minor_key, 6),
    "A:maj", circshift(major_key, 9),
    "C#:min", circshift(minor_key, 1),
    "E:maj", circshift(major_key, 4),
    "G#:min", circshift(minor_key, 8),
    "B:maj", circshift(major_key, 11),
    "D#:min", circshift(minor_key, 3)
  )


sundial <-
  get_tidy_audio_analysis("3gCurfVJRI2d5vov0eF6ka") %>%
  compmus_align(sections, segments) %>%
  select(sections) %>%
  unnest(sections) %>%
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "mean", norm = "manhattan"
      )
  )

sundial %>% 
  compmus_match_pitch_template(
    key_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "manhattan"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  theme_minimal() +
  labs(x = "Time (s)", y = "") + ggtitle("Sundial by Bicep, keygram") + scale_fill_viridis_c('energy')

sputnik <-
  get_tidy_audio_analysis("00BsCMMLOc0djHZWRm8Dlg") %>%
  compmus_align(sections, segments) %>%
  select(sections) %>%
  unnest(sections) %>%
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "mean", norm = "manhattan"
      )
  )

sputnik %>% 
  compmus_match_pitch_template(
    key_templates,         # Change to chord_templates if descired
    method = "euclidean",  # Try different distance metrics
    norm = "manhattan"     # Try different norms
  ) %>%
  ggplot(
    aes(x = start + duration / 2, width = duration, y = name, fill = d)
  ) +
  geom_tile() +
  theme_minimal() +
  labs(x = "Time (s)", y = "") + ggtitle("Sputnik by Bodzin, keygram") + scale_fill_viridis_c('energy')



bicep <- get_playlist_audio_features("", "45igKB0TM7fCIDJVo8dWpZ")
bodzin <- get_playlist_audio_features("", "4DgGHEYzIbiKwBZaXdkVvF")
  
  
bicep %>%
  count(key_mode, sort = TRUE) %>%
  ggplot(aes(reorder(key_mode, n), n))+
  geom_col(fill = "#6495ED") + coord_flip() + labs() + ggtitle("histogram of keys - Bicep ")

bodzin %>%
  count(key_mode, sort = TRUE) %>%
  ggplot(aes(reorder(key_mode, n), n))+
  geom_col(fill = "#6495ED") + coord_flip() + labs() + ggtitle("histogram of keys - Bodzin")


```


***
dark = more energy // light = little energy. 

Above is a histogram of keys for both the Bicep and Bodzin playlists I Made for my corpus.

Clearly, the C minor and A minor are significantly prevailing in Biceps music.According to Pauer, C minor is the key that is expressive of softness, longing, sadness, solemnity, dignified earnestness, and a passionate intensity. It lends itself most effectively to the portraiture of the supernatural (source https://interlude.hk/feel-key-c-minor/#:~:text=According%20to%20Pauer%2C%20C%20minor,the%20portraiture%20of%20the%20supernatural).

The G major and A# minor are prevailing in Bodzins music. G major is expressing the Serious, Magnificent and fantasy (source https://ledgernote.com/blog/interesting/musical-key-characteristics-emotions/). If would say this is reflected in Bodzins' music: his songs sound extraterrestrial which I would say is mainly caused by his characteristic base sound. 
Also I plotted some keygrams from both Bicep and Bodzin to see whether these songs reflects the most typical keys of the artist. [further explanation]

### tempograms

```{r}
drift <- get_tidy_audio_analysis("5xvHKh0QAbzYUUiazFGnAD")

drift %>%
  tempogram(window_size = 8, hop_size = 1, cyclic = TRUE) %>%
  ggplot(aes(x = time, y = bpm, fill = power)) +
  geom_raster() +
  scale_fill_viridis_c(guide = "none") +
  labs(x = "Time (s)", y = "Tempo (BPM)") +
  theme_classic() + scale_fill_viridis_c('tempo')

```
***



This is a tempogram of outlier 'Drift' by Bicep. Analysis: 

- Throughout the whole song, until +- 200 s, the tempo remains around the 127 bpm. 
- After 200s, near the end of the song, the tempo suddenly goes all over the place. It is not possible to measure a specific tempo measure. 

The song Drift is built up from the same, mysterious sounding rhythm. This rhythms goes on throughout the whole song and there is no voice. This is why is tempogram remains mostly the same.

However near the end of the song another sound (a very high voice / sound going like 'whoooooo') is added to the ongoing rhythm. This sound is clearly having a slower tempo than the main rhythm. Because of these two different tempo's suddenly mixing together, the tempogram goes at all kinds of different tempo's which is clearly visible. This makes Drift an interesting outlier. 


### Conclusion and Discussion

```{r}

```

